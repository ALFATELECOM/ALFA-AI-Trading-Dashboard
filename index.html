<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AlgoTrade Pro - Complete Algorithmic Trading Platform</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet"/>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #6366f1;
            --secondary-color: #8b5cf6;
            --accent-color: #06d6a0;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --danger-color: #ef4444;
            --dark-bg: #0f172a;
            --light-bg: #f8fafc;
            --card-bg: #ffffff;
            --text-dark: #1e293b;
            --text-light: #64748b;
            --border-color: #e2e8f0;
            --gradient: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            --success-gradient: linear-gradient(135deg, var(--success-color), var(--accent-color));
            --danger-gradient: linear-gradient(135deg, var(--danger-color), #dc2626);
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            line-height: 1.6;
            color: var(--text-dark);
            background: var(--light-bg);
            overflow-x: hidden;
        }

        body.dark-mode {
            --light-bg: #0f172a;
            --card-bg: #1e293b;
            --text-dark: #f1f5f9;
            --text-light: #94a3b8;
            --border-color: #334155;
        }

        .main-layout {
            display: grid;
            grid-template-columns: 280px 1fr;
            grid-template-rows: 70px 1fr;
            height: 100vh;
            grid-template-areas: 
                "sidebar header"
                "sidebar content";
        }

        /* Header */
        .header {
            grid-area: header;
            background: var(--card-bg);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .search-box {
            position: relative;
        }

        .search-box input {
            padding: 8px 15px 8px 40px;
            border: 2px solid var(--border-color);
            border-radius: 20px;
            width: 300px;
            font-size: 14px;
        }

        .search-box i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-light);
        }

        /* Sidebar */
        .sidebar {
            grid-area: sidebar;
            background: var(--card-bg);
            border-right: 1px solid var(--border-color);
            padding: 20px 0;
            overflow-y: auto;
        }

        .logo {
            text-align: center;
            margin-bottom: 30px;
            padding: 0 20px;
        }

        .logo h2 {
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: bold;
        }

        .nav-menu {
            list-style: none;
        }

        .nav-item {
            margin-bottom: 5px;
        }

        .nav-link {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 20px;
            color: var(--text-dark);
            text-decoration: none;
            transition: all 0.3s ease;
            border-right: 3px solid transparent;
        }

        .nav-link:hover, .nav-link.active {
            background: rgba(99, 102, 241, 0.1);
            border-right-color: var(--primary-color);
            color: var(--primary-color);
        }

        .nav-link i {
            width: 20px;
            text-align: center;
        }

        /* Content Area */
        .content {
            grid-area: content;
            padding: 30px;
            overflow-y: auto;
            background: var(--light-bg);
        }

        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .page-title {
            font-size: 2rem;
            font-weight: 700;
            color: var(--text-dark);
        }

        /* Cards */
        .card {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            border: 1px solid var(--border-color);
            margin-bottom: 20px;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .card-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--text-dark);
        }

        /* Buttons */
        .btn {
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 600;
            text-decoration: none;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background: var(--secondary-color);
            transform: translateY(-2px);
        }

        .btn-success {
            background: var(--success-color);
            color: white;
        }

        .btn-warning {
            background: var(--warning-color);
            color: white;
        }

        .btn-danger {
            background: var(--danger-color);
            color: white;
        }

        .btn-secondary {
            background: transparent;
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
        }

        .btn-sm {
            padding: 6px 12px;
            font-size: 12px;
        }

        /* Grid Layouts */
        .grid-2 {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }

        .grid-4 {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
        }

        /* Strategy Builder */
        .strategy-builder {
            display: grid;
            grid-template-columns: 250px 1fr 300px;
            gap: 20px;
            height: 600px;
        }

        .components-panel {
            background: var(--card-bg);
            border-radius: 10px;
            padding: 20px;
            overflow-y: auto;
        }

        .canvas-area {
            background: var(--card-bg);
            border-radius: 10px;
            position: relative;
            overflow: hidden;
            border: 2px dashed var(--border-color);
        }

        .properties-panel {
            background: var(--card-bg);
            border-radius: 10px;
            padding: 20px;
            overflow-y: auto;
        }

        .component-item {
            padding: 10px;
            margin: 5px 0;
            background: var(--light-bg);
            border-radius: 6px;
            cursor: move;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .component-item:hover {
            background: rgba(99, 102, 241, 0.1);
            border-color: var(--primary-color);
        }

        /* Charts */
        .chart-container {
            height: 400px;
            background: var(--card-bg);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-light);
            border: 1px solid var(--border-color);
            flex-direction: column;
        }

        /* Tables */
        .table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        .table th,
        .table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        .table th {
            background: var(--light-bg);
            font-weight: 600;
            color: var(--text-dark);
        }

        .table tr:hover {
            background: rgba(99, 102, 241, 0.05);
        }

        /* Status Indicators */
        .status {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status.running {
            background: rgba(16, 185, 129, 0.2);
            color: var(--success-color);
        }

        .status.stopped {
            background: rgba(239, 68, 68, 0.2);
            color: var(--danger-color);
        }

        .status.paused {
            background: rgba(245, 158, 11, 0.2);
            color: var(--warning-color);
        }

        /* Modals */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: var(--card-bg);
            margin: 5% auto;
            padding: 30px;
            width: 90%;
            max-width: 800px;
            border-radius: 15px;
            position: relative;
            max-height: 80vh;
            overflow-y: auto;
        }

        .close {
            color: var(--text-light);
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            position: absolute;
            right: 20px;
            top: 15px;
        }

        .close:hover {
            color: var(--text-dark);
        }

        /* Forms */
        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-dark);
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        /* Tabs */
        .tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 20px;
            background: var(--light-bg);
            padding: 5px;
            border-radius: 10px;
        }

        .tab-btn {
            flex: 1;
            padding: 12px 20px;
            border: none;
            background: transparent;
            cursor: pointer;
            border-radius: 8px;
            font-weight: 500;
            transition: all 0.3s ease;
            color: var(--text-dark);
        }

        .tab-btn.active {
            background: var(--card-bg);
            color: var(--primary-color);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Metrics Cards */
        .metric-card {
            text-align: center;
            padding: 20px;
            background: var(--card-bg);
            border-radius: 10px;
            border: 1px solid var(--border-color);
        }

        .metric-value {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .metric-label {
            color: var(--text-light);
            font-size: 0.9rem;
        }

        .metric-change {
            font-size: 0.8rem;
            margin-top: 5px;
        }

        .positive {
            color: var(--success-color);
        }

        .negative {
            color: var(--danger-color);
        }

        /* Code Editor */
        .code-editor {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
            min-height: 300px;
            border: 1px solid var(--border-color);
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideIn {
            from { transform: translateX(-100%); }
            to { transform: translateX(0); }
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .fade-in {
            animation: fadeIn 0.5s ease;
        }

        .slide-in {
            animation: slideIn 0.3s ease;
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .main-layout {
                grid-template-columns: 250px 1fr;
            }
        }

        @media (max-width: 768px) {
            .main-layout {
                grid-template-columns: 1fr;
                grid-template-areas: 
                    "header"
                    "content";
            }
            
            .sidebar {
                display: none;
            }
            
            .grid-4 {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .grid-3 {
                grid-template-columns: 1fr;
            }
            
            .strategy-builder {
                grid-template-columns: 1fr;
                grid-template-rows: auto auto auto;
                height: auto;
            }
        }

        /* Page-specific styles */
        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        /* Dark mode toggle */
        .theme-toggle {
            background: none;
            border: 2px solid var(--primary-color);
            color: var(--primary-color);
            padding: 8px 12px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .theme-toggle:hover {
            background: var(--primary-color);
            color: white;
        }

        /* Notification system */
        .notifications {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 3000;
        }

        .notification {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            max-width: 350px;
            animation: slideIn 0.3s ease;
        }

        .notification.success {
            border-left: 4px solid var(--success-color);
        }

        .notification.error {
            border-left: 4px solid var(--danger-color);
        }

        .notification.warning {
            border-left: 4px solid var(--warning-color);
        }

        /* Coming Soon Styles */
        .coming-soon {
            text-align: center;
            padding: 100px 20px;
            background: var(--card-bg);
            border-radius: 15px;
            border: 2px dashed var(--border-color);
        }

        .coming-soon h2 {
            font-size: 2.5rem;
            margin-bottom: 20px;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .coming-soon p {
            font-size: 1.2rem;
            color: var(--text-light);
            margin-bottom: 30px;
        }

        .coming-soon i {
            font-size: 4rem;
            color: var(--primary-color);
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="main-layout">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" placeholder="Search strategies, symbols, or commands...">
                </div>
            </div>
            <div class="header-right">
                <span id="system-status" class="status running">SYSTEM ONLINE</span>
                <button class="theme-toggle" onclick="toggleTheme()">
                    <i class="fas fa-moon"></i>
                </button>
                <div class="user-profile">
                    <i class="fas fa-user-circle" style="font-size: 1.5rem; color: var(--primary-color);"></i>
                </div>
            </div>
        </header>

        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="logo">
                <h2><i class="fas fa-chart-line"></i> AlgoTrade Pro</h2>
            </div>
            <nav>
                <ul class="nav-menu">
                    <li class="nav-item">
                        <a href="#dashboard" class="nav-link active" onclick="showPage('dashboard')">
                            <i class="fas fa-tachometer-alt"></i>
                            <span>Dashboard</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#strategy-builder" class="nav-link" onclick="showPage('strategy-builder')">
                            <i class="fas fa-code-branch"></i>
                            <span>Strategy Builder</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#backtesting" class="nav-link" onclick="showPage('backtesting')">
                            <i class="fas fa-history"></i>
                            <span>Backtesting</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#live-trading" class="nav-link" onclick="showPage('live-trading')">
                            <i class="fas fa-bolt"></i>
                            <span>Live Trading</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#portfolio" class="nav-link" onclick="showPage('portfolio')">
                            <i class="fas fa-briefcase"></i>
                            <span>Portfolio</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#risk-management" class="nav-link" onclick="showPage('risk-management')">
                            <i class="fas fa-shield-alt"></i>
                            <span>Risk Management</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#market-data" class="nav-link" onclick="showPage('market-data')">
                            <i class="fas fa-chart-bar"></i>
                            <span>Market Data</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#research" class="nav-link" onclick="showPage('research')">
                            <i class="fas fa-flask"></i>
                            <span>Research Lab</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#optimization" class="nav-link" onclick="showPage('optimization')">
                            <i class="fas fa-cogs"></i>
                            <span>Optimization</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#alerts" class="nav-link" onclick="showPage('alerts')">
                            <i class="fas fa-bell"></i>
                            <span>Alerts & Signals</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#analytics" class="nav-link" onclick="showPage('analytics')">
                            <i class="fas fa-analytics"></i>
                            <span>Analytics</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#paper-trading" class="nav-link" onclick="showPage('paper-trading')">
                            <i class="fas fa-file-alt"></i>
                            <span>Paper Trading</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#options-trading" class="nav-link" onclick="showPage('options-trading')">
                            <i class="fas fa-chart-pie"></i>
                            <span>Options Trading</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#trade-reports" class="nav-link" onclick="showPage('trade-reports')">
                            <i class="fas fa-file-invoice"></i>
                            <span>Trade Reports</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#broker-integration" class="nav-link" onclick="showPage('broker-integration')">
                            <i class="fas fa-plug"></i>
                            <span>Broker Integration</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#settings" class="nav-link" onclick="showPage('settings')">
                            <i class="fas fa-cog"></i>
                            <span>Settings</span>
                        </a>
                    </li>
                </ul>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="content">
            <!-- Dashboard Page -->
            <div id="dashboard" class="page active">
                <div class="page-header">
                    <h1 class="page-title">Trading Dashboard</h1>
                    <div>
                        <button class="btn btn-primary" onclick="showModal('quick-strategy-modal')">
                            <i class="fas fa-plus"></i> Quick Strategy
                        </button>
                        <button class="btn btn-success" onclick="startAllStrategies()">
                            <i class="fas fa-play"></i> Start All
                        </button>
                    </div>
                </div>

                <!-- Key Metrics -->
                <div class="grid-4" style="margin-bottom: 30px;">
                    <div class="metric-card">
                        <div class="metric-value positive" id="total-pnl">+â‚¹45,680</div>
                        <div class="metric-label">Total P&L</div>
                        <div class="metric-change positive">+12.4% today</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" style="color: var(--primary-color);" id="active-strategies">8</div>
                        <div class="metric-label">Active Strategies</div>
                        <div class="metric-change">2 optimizing</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" style="color: var(--warning-color);" id="risk-exposure">68%</div>
                        <div class="metric-label">Risk Exposure</div>
                        <div class="metric-change">Within limits</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value positive" id="win-rate">84.2%</div>
                        <div class="metric-label">Win Rate</div>
                        <div class="metric-change positive">+2.1% this week</div>
                    </div>
                </div>

                <div class="grid-2">
                    <!-- Active Strategies -->
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Active Strategies</h3>
                            <button class="btn btn-sm btn-secondary" onclick="refreshStrategies()">
                                <i class="fas fa-sync"></i> Refresh
                            </button>
                        </div>
                        <div id="strategies-list">
                            <!-- Strategies will be populated here -->
                        </div>
                    </div>

                    <!-- Performance Chart -->
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Portfolio Performance</h3>
                            <div class="tabs" style="width: auto; margin: 0;">
                                <button class="tab-btn active" onclick="updateChart('1D')">1D</button>
                                <button class="tab-btn" onclick="updateChart('1W')">1W</button>
                                <button class="tab-btn" onclick="updateChart('1M')">1M</button>
                            </div>
                        </div>
                        <div class="chart-container">
                            <i class="fas fa-chart-line" style="font-size: 3rem; margin-bottom: 15px;"></i>
                            <div>Interactive Performance Chart</div>
                        </div>
                    </div>
                </div>

                <!-- Recent Trades -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Recent Trades</h3>
                        <button class="btn btn-sm btn-primary" onclick="showModal('trade-details-modal')">
                            <i class="fas fa-list"></i> View All
                        </button>
                    </div>
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Time</th>
                                <th>Strategy</th>
                                <th>Symbol</th>
                                <th>Side</th>
                                <th>Quantity</th>
                                <th>Price</th>
                                <th>P&L</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody id="recent-trades">
                            <!-- Trades will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Paper Trading Page -->
            <div id="paper-trading" class="page">
                <div class="page-header">
                    <h1 class="page-title">Paper Trading Environment</h1>
                    <div>
                        <span class="status running">ðŸ“Š SIMULATION MODE</span>
                        <button class="btn btn-primary" onclick="resetPaperAccount()">
                            <i class="fas fa-refresh"></i> Reset Account
                        </button>
                    </div>
                </div>

                <!-- Paper Trading Stats -->
                <div class="grid-4">
                    <div class="metric-card">
                        <div class="metric-value" style="color: var(--primary-color);" id="paper-portfolio-value">â‚¹10,45,680</div>
                        <div class="metric-label">Virtual Portfolio Value</div>
                        <div class="metric-change positive" id="paper-portfolio-change">+â‚¹45,680 (+4.57%)</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="paper-trades-count">156</div>
                        <div class="metric-label">Total Paper Trades</div>
                        <div class="metric-change">89 Wins | 67 Loss</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value positive" id="paper-win-rate">57.1%</div>
                        <div class="metric-label">Win Rate</div>
                        <div class="metric-change positive">+2.3% this week</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" style="color: var(--accent-color);" id="paper-available-cash">â‚¹2,54,320</div>
                        <div class="metric-label">Available Cash</div>
                        <div class="metric-change">25.4% of portfolio</div>
                    </div>
                </div>

                <div class="grid-2">
                    <!-- Paper Trading Controls -->
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Quick Paper Trade</h3>
                        </div>
                        <div class="form-group">
                            <label>Symbol</label>
                            <input type="text" id="paper-symbol" placeholder="e.g., RELIANCE" style="width: 100%; padding: 10px; border: 1px solid var(--border-color); border-radius: 5px;">
                        </div>
                        <div class="grid-2">
                            <div class="form-group">
                                <label>Quantity</label>
                                <input type="number" id="paper-quantity" value="1" min="1" style="width: 100%; padding: 10px; border: 1px solid var(--border-color); border-radius: 5px;">
                            </div>
                            <div class="form-group">
                                <label>Order Type</label>
                                <select id="paper-order-type" style="width: 100%; padding: 10px; border: 1px solid var(--border-color); border-radius: 5px;">
                                    <option value="market">Market</option>
                                    <option value="limit">Limit</option>
                                    <option value="sl">Stop Loss</option>
                                    <option value="sl-m">Stop Loss Market</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group" id="paper-price-group" style="display: none;">
                            <label>Price</label>
                            <input type="number" id="paper-price" step="0.01" style="width: 100%; padding: 10px; border: 1px solid var(--border-color); border-radius: 5px;">
                        </div>
                        <div style="display: flex; gap: 10px; margin-top: 20px;">
                            <button class="btn btn-success" onclick="placePaperTrade('BUY')" style="flex: 1;">
                                <i class="fas fa-arrow-up"></i> Buy
                            </button>
                            <button class="btn btn-danger" onclick="placePaperTrade('SELL')" style="flex: 1;">
                                <i class="fas fa-arrow-down"></i> Sell
                            </button>
                        </div>
                    </div>

                    <!-- Paper Portfolio Holdings -->
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Paper Portfolio Holdings</h3>
                        </div>
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Symbol</th>
                                    <th>Qty</th>
                                    <th>Avg Price</th>
                                    <th>LTP</th>
                                    <th>P&L</th>
                                </tr>
                            </thead>
                            <tbody id="paper-holdings-table">
                                <!-- Holdings will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Paper Trading Performance -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Paper Trading Performance</h3>
                        <div class="tabs" style="width: auto; margin: 0;">
                            <button class="tab-btn active" onclick="updatePaperChart('1D')">1D</button>
                            <button class="tab-btn" onclick="updatePaperChart('1W')">1W</button>
                            <button class="tab-btn" onclick="updatePaperChart('1M')">1M</button>
                            <button class="tab-btn" onclick="updatePaperChart('3M')">3M</button>
                        </div>
                    </div>
                    <div class="chart-container">
                        <i class="fas fa-chart-line" style="font-size: 3rem; margin-bottom: 15px; color: var(--accent-color);"></i>
                        <div>Paper Trading Equity Curve</div>
                        <div style="margin-top: 10px; color: var(--text-light);">
                            Track your virtual trading performance over time
                        </div>
                    </div>
                </div>
            </div>

            <!-- Strategy Builder Page -->
            <div id="strategy-builder" class="page">
                <div class="coming-soon">
                    <i class="fas fa-code-branch"></i>
                    <h2>Strategy Builder</h2>
                    <p>Advanced visual strategy builder with drag-and-drop components</p>
                    <div class="btn btn-primary" onclick="showNotification('Strategy Builder coming soon with advanced features!', 'success')">
                        <i class="fas fa-rocket"></i> Coming Soon
                    </div>
                </div>
            </div>

            <!-- Backtesting Page -->
            <div id="backtesting" class="page">
                <div class="coming-soon">
                    <i class="fas fa-history"></i>
                    <h2>Strategy Backtesting</h2>
                    <p>Comprehensive backtesting engine with historical data analysis</p>
                    <div class="btn btn-primary" onclick="showNotification('Backtesting engine coming soon!', 'success')">
                        <i class="fas fa-rocket"></i> Coming Soon
                    </div>
                </div>
            </div>

            <!-- Live Trading Page -->
            <div id="live-trading" class="page">
                <div class="coming-soon">
                    <i class="fas fa-bolt"></i>
                    <h2>Live Trading</h2>
                    <p>Real-time trading with broker integration and risk management</p>
                    <div class="btn btn-primary" onclick="showNotification('Live trading interface coming soon!', 'success')">
                        <i class="fas fa-rocket"></i> Coming Soon
                    </div>
                </div>
            </div>

            <!-- Portfolio Page -->
            <div id="portfolio" class="page">
                <div class="coming-soon">
                    <i class="fas fa-briefcase"></i>
                    <h2>Portfolio Management</h2>
                    <p>Comprehensive portfolio tracking and analysis tools</p>
                    <div class="btn btn-primary" onclick="showNotification('Portfolio management coming soon!', 'success')">
                        <i class="fas fa-rocket"></i> Coming Soon
                    </div>
                </div>
            </div>

            <!-- Risk Management Page -->
            <div id="risk-management" class="page">
                <div class="coming-soon">
                    <i class="fas fa-shield-alt"></i>
                    <h2>Risk Management</h2>
                    <p>Advanced risk controls and monitoring systems</p>
                    <div class="btn btn-primary" onclick="showNotification('Risk management tools coming soon!', 'success')">
                        <i class="fas fa-rocket"></i> Coming Soon
                    </div>
                </div>
            </div>

            <!-- Market Data Page -->
            <div id="market-data" class="page">
                <div class="coming-soon">
                    <i class="fas fa-chart-bar"></i>
                    <h2>Live Market Data</h2>
                    <p>Real-time market feeds with advanced charting and analysis</p>
                    <div class="btn btn-primary" onclick="showNotification('Market data feeds coming soon!', 'success')">
                        <i class="fas fa-rocket"></i> Coming Soon
                    </div>
                </div>
            </div>

            <!-- Research Lab Page -->
            <div id="research" class="page">
                <div class="coming-soon">
                    <i class="fas fa-flask"></i>
                    <h2>Research Laboratory</h2>
                    <p>Advanced research tools and data analysis capabilities</p>
                    <div class="btn btn-primary" onclick="showNotification('Research lab coming soon!', 'success')">
                        <i class="fas fa-rocket"></i> Coming Soon
                    </div>
                </div>
            </div>

            <!-- Optimization Page -->
            <div id="optimization" class="page">
                <div class="coming-soon">
                    <i class="fas fa-cogs"></i>
                    <h2>Strategy Optimization</h2>
                    <p>Genetic algorithms and machine learning optimization</p>
                    <div class="btn btn-primary" onclick="showNotification('Optimization engine coming soon!', 'success')">
                        <i class="fas fa-rocket"></i> Coming Soon
                    </div>
                </div>
            </div>

            <!-- Alerts Page -->
            <div id="alerts" class="page">
                <div class="coming-soon">
                    <i class="fas fa-bell"></i>
                    <h2>Alerts & Signals</h2>
                    <p>Smart notifications and trading signals system</p>
                    <div class="btn btn-primary" onclick="showNotification('Alerts system coming soon!', 'success')">
                        <i class="fas fa-rocket"></i> Coming Soon
                    </div>
                </div>
            </div>

            <!-- Analytics Page -->
            <div id="analytics" class="page">
                <div class="coming-soon">
                    <i class="fas fa-analytics"></i>
                    <h2>Advanced Analytics</h2>
                    <p>Comprehensive performance analytics and reporting</p>
                    <div class="btn btn-primary" onclick="showNotification('Analytics suite coming soon!', 'success')">
                        <i class="fas fa-rocket"></i> Coming Soon
                    </div>
                </div>
            </div>

            <!-- Options Trading Page -->
            <div id="options-trading" class="page">
                <div class="coming-soon">
                    <i class="fas fa-chart-pie"></i>
                    <h2>Options Trading</h2>
                    <p>Advanced options analysis with Greeks and strategy builder</p>
                    <div class="btn btn-primary" onclick="showNotification('Options trading platform coming soon!', 'success')">
                        <i class="fas fa-rocket"></i> Coming Soon
                    </div>
                </div>
            </div>

            <!-- Trade Reports Page -->
            <div id="trade-reports" class="page">
                <div class="coming-soon">
                    <i class="fas fa-file-invoice"></i>
                    <h2>Trade Reports</h2>
                    <p>Comprehensive trade analysis and tax reporting tools</p>
                    <div class="btn btn-primary" onclick="showNotification('Trade reports coming soon!', 'success')">
                        <i class="fas fa-rocket"></i> Coming Soon
                    </div>
                </div>
            </div>

            <!-- Broker Integration Page -->
            <div id="broker-integration" class="page">
                <div class="coming-soon">
                    <i class="fas fa-plug"></i>
                    <h2>Broker Integration</h2>
                    <p>Seamless integration with multiple brokers and APIs</p>
                    <div class="btn btn-primary" onclick="showNotification('Broker integration coming soon!', 'success')">
                        <i class="fas fa-rocket"></i> Coming Soon
                    </div>
                </div>
            </div>

            <!-- Settings Page -->
            <div id="settings" class="page">
                <div class="coming-soon">
                    <i class="fas fa-cog"></i>
                    <h2>System Settings</h2>
                    <p>Platform configuration and user preferences</p>
                    <div class="btn btn-primary" onclick="showNotification('Settings panel coming soon!', 'success')">
                        <i class="fas fa-rocket"></i> Coming Soon
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Notification Container -->
    <div class="notifications" id="notifications"></div>

    <!-- Quick Strategy Modal -->
    <div id="quick-strategy-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('quick-strategy-modal')">&times;</span>
            <h2>Quick Strategy Creator</h2>
            <form onsubmit="createQuickStrategy(event)">
                <div class="form-group">
                    <label>Strategy Name</label>
                    <input type="text" required placeholder="My Quick Strategy">
                </div>
                <div class="form-group">
                    <label>Template</label>
                    <select>
                        <option>Simple Moving Average Crossover</option>
                        <option>RSI Overbought/Oversold</option>
                        <option>Bollinger Band Breakout</option>
                        <option>MACD Signal</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Symbol</label>
                    <input type="text" required placeholder="RELIANCE">
                </div>
                <div class="form-group">
                    <label>Timeframe</label>
                    <select>
                        <option>1 minute</option>
                        <option>5 minutes</option>
                        <option>15 minutes</option>
                        <option>1 hour</option>
                        <option>1 day</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Capital Allocation (â‚¹)</label>
                    <input type="number" value="50000" required>
                </div>
                <div style="text-align: center; margin-top: 30px;">
                    <button type="submit" class="btn btn-primary">Create Strategy</button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal('quick-strategy-modal')">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Trade Details Modal -->
    <div id="trade-details-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('trade-details-modal')">&times;</span>
            <h2>All Trades</h2>
            <p>Comprehensive trade details view coming soon!</p>
        </div>
    </div>

    <script>
        // Initialize sample data and global variables
        let currentPage = 'dashboard';
        let authToken = null;
        let currentUser = null;
        let socket = null;

        // Initialize paper portfolio
        window.paperPortfolio = {
            value: 1000000,
            cash: 1000000,
            trades: 0,
            winRate: 57.1,
            holdings: [
                { symbol: 'RELIANCE', qty: 50, avgPrice: 2450, current: 2485 },
                { symbol: 'TCS', qty: 25, avgPrice: 3680, current: 3695 },
                { symbol: 'INFY', qty: 40, avgPrice: 1420, current: 1435 }
            ]
        };

        // Sample strategies data
        let strategies = [
            { id: 1, name: 'Momentum Pro v2.1', status: 'running', pnl: 12450, trades: 45, winRate: 72.5 },
            { id: 2, name: 'Mean Reversion Master', status: 'paused', pnl: 8920, trades: 32, winRate: 68.8 },
            { id: 3, name: 'Arbitrage Scanner', status: 'running', pnl: 15680, trades: 67, winRate: 89.2 },
            { id: 4, name: 'Options Scalper', status: 'running', pnl: 9230, trades: 23, winRate: 65.2 },
            { id: 5, name: 'Trend Following Bot', status: 'stopped', pnl: -2340, trades: 18, winRate: 44.4 },
            { id: 6, name: 'Swing Trader Elite', status: 'running', pnl: 6780, trades: 29, winRate: 75.9 },
            { id: 7, name: 'Breakout Hunter', status: 'paused', pnl: 4560, trades: 21, winRate: 71.4 },
            { id: 8, name: 'Range Master Pro', status: 'running', pnl: 11230, trades: 38, winRate: 78.9 }
        ];

        // Sample trades data
        let trades = [
            { time: '14:32:15', strategy: 'Momentum Pro', symbol: 'RELIANCE', side: 'BUY', quantity: 50, price: 2485, pnl: 1750, status: 'FILLED' },
            { time: '14:25:42', strategy: 'Mean Reversion', symbol: 'TCS', side: 'SELL', quantity: 25, price: 3695, pnl: -320, status: 'FILLED' },
            { time: '14:18:30', strategy: 'Arbitrage', symbol: 'INFY', side: 'BUY', quantity: 40, price: 1435, pnl: 600, status: 'FILLED' },
            { time: '14:10:18', strategy: 'Options Scalper', symbol: 'NIFTY 19850 CE', side: 'SELL', quantity: 100, price: 45.5, pnl: 2100, status: 'FILLED' },
            { time: '14:05:22', strategy: 'Trend Following', symbol: 'BANKNIFTY', side: 'BUY', quantity: 1, price: 45280, pnl: -150, status: 'FILLED' }
        ];

        // Market data with proper initialization
        let marketData = {
            nifty: { price: 19845, change: 125, changePercent: 0.63 },
            banknifty: { price: 45280, change: -89, changePercent: -0.20 },
            sensex: { price: 66795, change: 234, changePercent: 0.35 },
            vix: { price: 14.85, change: -0.45, changePercent: -2.94 }
        };

        // Paper Trading Functions
        async function placePaperTrade(side) {
            const symbol = document.getElementById('paper-symbol').value.trim().toUpperCase();
            const quantity = parseInt(document.getElementById('paper-quantity').value);
            const orderType = document.getElementById('paper-order-type').value;
            const price = parseFloat(document.getElementById('paper-price').value) || 0;

            if (!symbol || quantity <= 0) {
                showNotification('Please enter valid symbol and quantity', 'error');
                return;
            }

            try {
                // Simulate order placement with realistic pricing
                const currentPrice = Math.floor(Math.random() * 1000) + 1000; // Random price for demo
                const executionPrice = orderType === 'market' ? currentPrice : price;
                
                showNotification(`ðŸ“Š Paper ${side} order placed for ${quantity} ${symbol} at â‚¹${executionPrice}`, 'success');
                
                // Update paper portfolio
                if (!window.paperPortfolio) {
                    window.paperPortfolio = {
                        value: 1000000,
                        cash: 1000000,
                        trades: 0,
                        winRate: 0,
                        holdings: []
                    };
                }
                
                paperPortfolio.trades++;
                const tradeValue = quantity * executionPrice;
                
                if (side === 'BUY') {
                    if (paperPortfolio.cash >= tradeValue) {
                        paperPortfolio.cash -= tradeValue;
                        // Add to holdings
                        const existingHolding = paperPortfolio.holdings.find(h => h.symbol === symbol);
                        if (existingHolding) {
                            const totalQty = existingHolding.qty + quantity;
                            existingHolding.avgPrice = ((existingHolding.avgPrice * existingHolding.qty) + tradeValue) / totalQty;
                            existingHolding.qty = totalQty;
                        } else {
                            paperPortfolio.holdings.push({
                                symbol: symbol,
                                qty: quantity,
                                avgPrice: executionPrice,
                                current: executionPrice
                            });
                        }
                    } else {
                        showNotification('Insufficient cash for this trade', 'error');
                        return;
                    }
                } else {
                    // SELL
                    const existingHolding = paperPortfolio.holdings.find(h => h.symbol === symbol);
                    if (existingHolding && existingHolding.qty >= quantity) {
                        paperPortfolio.cash += tradeValue;
                        existingHolding.qty -= quantity;
                        if (existingHolding.qty <= 0) {
                            paperPortfolio.holdings = paperPortfolio.holdings.filter(h => h.symbol !== symbol);
                        }
                    } else {
                        showNotification('Insufficient holdings to sell', 'error');
                        return;
                    }
                }
                
                // Update portfolio value
                paperPortfolio.value = paperPortfolio.cash + paperPortfolio.holdings.reduce((total, holding) => {
                    return total + (holding.qty * holding.current);
                }, 0);
                
                updatePaperPortfolioDisplay();
                renderPaperHoldings();
                
                // Clear form
                document.getElementById('paper-symbol').value = '';
                document.getElementById('paper-quantity').value = '1';
                
            } catch (error) {
                showNotification(`Failed to place paper trade: ${error.message}`, 'error');
            }
        }

        function updatePaperPortfolioDisplay() {
            // Calculate current portfolio value
            const holdingsValue = paperPortfolio.holdings.reduce((total, holding) => {
                return total + (holding.qty * holding.current);
            }, 0);
            
            paperPortfolio.value = paperPortfolio.cash + holdingsValue;
            
            // Update display elements
            const portfolioValueEl = document.getElementById('paper-portfolio-value');
            const tradesCountEl = document.getElementById('paper-trades-count');
            const winRateEl = document.getElementById('paper-win-rate');
            const availableCashEl = document.getElementById('paper-available-cash');
            
            if (portfolioValueEl) {
                portfolioValueEl.textContent = `â‚¹${paperPortfolio.value.toLocaleString()}`;
            }
            if (tradesCountEl) {
                tradesCountEl.textContent = paperPortfolio.trades;
            }
            if (winRateEl) {
                winRateEl.textContent = `${paperPortfolio.winRate}%`;
            }
            if (availableCashEl) {
                availableCashEl.textContent = `â‚¹${paperPortfolio.cash.toLocaleString()}`;
            }
        }

        function renderPaperHoldings() {
            const container = document.getElementById('paper-holdings-table');
            if (!container || !paperPortfolio.holdings) return;

            container.innerHTML = paperPortfolio.holdings.map(holding => {
                const pnl = (holding.current - holding.avgPrice) * holding.qty;
                return `
                    <tr>
                        <td><strong>${holding.symbol}</strong></td>
                        <td>${holding.qty}</td>
                        <td>â‚¹${holding.avgPrice.toFixed(2)}</td>
                        <td>â‚¹${holding.current.toFixed(2)}</td>
                        <td class="${pnl >= 0 ? 'positive' : 'negative'}">${pnl >= 0 ? '+' : ''}â‚¹${Math.abs(pnl).toFixed(0)}</td>
                    </tr>
                `;
            }).join('');
        }

        function resetPaperAccount() {
            if (confirm('Are you sure you want to reset your paper trading account? This will clear all positions and reset to â‚¹10,00,000.')) {
                window.paperPortfolio = {
                    value: 1000000,
                    cash: 1000000,
                    trades: 0,
                    winRate: 0,
                    holdings: []
                };
                updatePaperPortfolioDisplay();
                renderPaperHoldings();
                showNotification('ðŸ“Š Paper trading account reset successfully!', 'success');
            }
        }

        function updatePaperChart(timeframe) {
            // Update chart timeframe buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            showNotification(`Paper trading chart updated to ${timeframe} view`, 'success');
        }

        // Initialize Enhanced Application
        const initializeApp = () => {
            // Initialize paper portfolio display
            updatePaperPortfolioDisplay();
            renderPaperHoldings();
            
            // Initialize other components
            renderStrategies();
            renderTrades();
            
            // Set up event listeners
            setupEventListeners();
            
            // Start real-time updates
            startRealTimeUpdates();
            
            console.log('âœ… AlgoTrade Pro initialized successfully!');
        };

        // Set up event listeners
        const setupEventListeners = () => {
            // Order type change handler
            const orderTypeSelect = document.getElementById('paper-order-type');
            const priceGroup = document.getElementById('paper-price-group');
            
            if (orderTypeSelect && priceGroup) {
                orderTypeSelect.addEventListener('change', function() {
                    if (this.value === 'limit' || this.value === 'sl') {
                        priceGroup.style.display = 'block';
                    } else {
                        priceGroup.style.display = 'none';
                    }
                });
            }
        };

        // Strategy management
        function renderStrategies() {
            const container = document.getElementById('strategies-list');
            if (!container) return;

            container.innerHTML = strategies.map(strategy => `
                <div style="display: flex; justify-content: space-between; align-items: center; padding: 15px; border: 1px solid var(--border-color); border-radius: 8px; margin-bottom: 10px;">
                    <div style="flex: 1;">
                        <h5 style="margin: 0; color: var(--text-dark);">${strategy.name}</h5>
                        <div style="display: flex; gap: 15px; margin-top: 5px; font-size: 0.9rem; color: var(--text-light);">
                            <span>P&L: <strong class="${strategy.pnl >= 0 ? 'positive' : 'negative'}">â‚¹${strategy.pnl.toLocaleString()}</strong></span>
                            <span>Trades: ${strategy.trades}</span>
                            <span>Win Rate: ${strategy.winRate}%</span>
                        </div>
                    </div>
                    <div style="display: flex; gap: 8px; align-items: center;">
                        <span class="status ${strategy.status}">${strategy.status.toUpperCase()}</span>
                        <button class="btn btn-sm btn-secondary" onclick="toggleStrategy(${strategy.id})">
                            <i class="fas fa-${strategy.status === 'running' ? 'pause' : 'play'}"></i>
                        </button>
                        <button class="btn btn-sm btn-primary" onclick="editStrategy(${strategy.id})">
                            <i class="fas fa-edit"></i>
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function renderTrades() {
            const container = document.getElementById('recent-trades');
            if (!container) return;

            container.innerHTML = trades.map(trade => `
                <tr>
                    <td>${trade.time}</td>
                    <td>${trade.strategy}</td>
                    <td><strong>${trade.symbol}</strong></td>
                    <td><span class="status ${trade.side.toLowerCase() === 'buy' ? 'running' : 'stopped'}">${trade.side}</span></td>
                    <td>${trade.quantity}</td>
                    <td>â‚¹${trade.price}</td>
                    <td class="${trade.pnl >= 0 ? 'positive' : 'negative'}">â‚¹${trade.pnl}</td>
                    <td><span class="status running">${trade.status}</span></td>
                </tr>
            `).join('');
        }

        // Strategy functions
        function toggleStrategy(strategyId) {
            const strategy = strategies.find(s => s.id === strategyId);
            if (!strategy) return;

            strategy.status = strategy.status === 'running' ? 'paused' : 'running';
            renderStrategies();
            showNotification(`Strategy ${strategy.name} ${strategy.status}`, 'success');
        }

        function editStrategy(strategyId) {
            showNotification(`Opening strategy editor for ID: ${strategyId}`, 'success');
            showPage('strategy-builder');
        }

        function startAllStrategies() {
            strategies.forEach(strategy => {
                strategy.status = 'running';
            });
            renderStrategies();
            showNotification('All strategies started successfully!', 'success');
        }

        function refreshStrategies() {
            // Simulate data refresh
            strategies.forEach(strategy => {
                strategy.pnl += Math.floor(Math.random() * 1000) - 500;
                strategy.trades += Math.floor(Math.random() * 3);
            });
            renderStrategies();
            showNotification('Strategies data refreshed', 'success');
        }

        // Quick strategy creation
        function createQuickStrategy(event) {
            event.preventDefault();
            const formData = new FormData(event.target);
            
            const newStrategy = {
                id: strategies.length + 1,
                name: formData.get('strategyName') || 'Quick Strategy',
                status: 'paused',
                pnl: 0,
                trades: 0,
                winRate: 0,
                capital: parseInt(formData.get('capital')) || 50000
            };

            strategies.push(newStrategy);
            renderStrategies();
            closeModal('quick-strategy-modal');
            showNotification(`Strategy "${newStrategy.name}" created successfully!`, 'success');
        }

        // Navigation functions
        function showPage(pageId) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // Remove active from all nav links
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            
            // Show selected page
            document.getElementById(pageId).classList.add('active');
            event.target.closest('.nav-link').classList.add('active');
            
            currentPage = pageId;
            
            // Page-specific initialization
            if (pageId === 'paper-trading') {
                updatePaperPortfolioDisplay();
                renderPaperHoldings();
            }
        }

        // Chart functions
        function updateChart(timeframe) {
            // Update chart timeframe buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            showNotification(`Chart updated to ${timeframe} view`, 'success');
        }

        // Real-time updates
        function startRealTimeUpdates() {
            setInterval(() => {
                updateRealTimeData();
            }, 5000); // Update every 5 seconds
        }

        function updateRealTimeData() {
            // Update portfolio metrics
            updatePortfolioMetrics();
        }

        function updatePortfolioMetrics() {
            const pnlElement = document.getElementById('total-pnl');
            const activeStrategiesElement = document.getElementById('active-strategies');
            const riskExposureElement = document.getElementById('risk-exposure');
            const winRateElement = document.getElementById('win-rate');

            if (pnlElement) {
                const currentPnl = parseInt(pnlElement.textContent.replace(/[^\d-]/g, ''));
                const change = Math.floor(Math.random() * 1000) - 500;
                const newPnl = currentPnl + change;
                pnlElement.textContent = `${newPnl >= 0 ? '+' : ''}â‚¹${Math.abs(newPnl).toLocaleString()}`;
                pnlElement.className = newPnl >= 0 ? 'metric-value positive' : 'metric-value negative';
            }

            if (activeStrategiesElement) {
                const activeCount = strategies.filter(s => s.status === 'running').length;
                activeStrategiesElement.textContent = activeCount;
            }

            if (riskExposureElement) {
                const risk = Math.floor(Math.random() * 20) + 50;
                riskExposureElement.textContent = `${risk}%`;
            }

            if (winRateElement) {
                const winRate = (Math.random() * 20 + 70).toFixed(1);
                winRateElement.textContent = `${winRate}%`;
            }
        }

        // Modal functions
        function showModal(modalId) {
            document.getElementById(modalId).style.display = 'block';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // Theme functions
        function toggleTheme() {
            document.body.classList.toggle('dark-mode');
            const themeIcon = document.querySelector('.theme-toggle i');
            
            if (document.body.classList.contains('dark-mode')) {
                themeIcon.className = 'fas fa-sun';
                localStorage.setItem('theme', 'dark');
                showNotification('Dark mode activated', 'success');
            } else {
                themeIcon.className = 'fas fa-moon';
                localStorage.setItem('theme', 'light');
                showNotification('Light mode activated', 'success');
            }
        }

        // Notification system
        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            
            notification.innerHTML = `
                <div style="display: flex; align-items: center; gap: 10px;">
                    <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-triangle' : 'info-circle'}"></i>
                    <span>${message}</span>
                </div>
            `;
            
            const container = document.getElementById('notifications');
            container.appendChild(notification);
            
            // Auto remove after 5 seconds
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                }
            }, 5000);
        }

        // System monitoring
        function checkSystemHealth() {
            const status = document.getElementById('system-status');
            const isHealthy = Math.random() > 0.1; // 90% chance of being healthy
            
            if (isHealthy) {
                status.textContent = 'SYSTEM ONLINE';
                status.className = 'status running pulse';
            } else {
                status.textContent = 'SYSTEM WARNING';
                status.className = 'status paused';
                showNotification('System performance warning detected', 'warning');
            }
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.style.display = 'none';
            }
        }

        // Auto-reconnect WebSocket on failure
        const handleWebSocketReconnect = () => {
            if (!socket || (socket && socket.disconnected)) {
                console.log('Attempting WebSocket reconnection...');
                setTimeout(() => {
                    if (authToken) {
                        console.log('WebSocket reconnection feature ready for backend integration');
                    }
                }, 5000); // Retry after 5 seconds
            }
        };

        // Keyboard shortcuts
        document.addEventListener('keydown', function(event) {
            if (event.ctrlKey || event.metaKey) {
                switch(event.key) {
                    case 's':
                        event.preventDefault();
                        showNotification('Settings saved!', 'success');
                        break;
                    case 'n':
                        event.preventDefault();
                        if (currentPage === 'dashboard') {
                            showModal('quick-strategy-modal');
                        }
                        break;
                    case 'r':
                        event.preventDefault();
                        refreshStrategies();
                        break;
                }
            }
            
            // ESC to close modals
            if (event.key === 'Escape') {
                document.querySelectorAll('.modal').forEach(modal => {
                    modal.style.display = 'none';
                });
            }
        });

        // Update initialization to use enhanced backend integration
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize app with basic functionality first
            initializeApp();
            
            // Set up auto-reconnect for future backend integration
            setInterval(() => {
                if (authToken) {
                    handleWebSocketReconnect();
                }
            }, 30000); // Check every 30 seconds
            
            showNotification('ðŸš€ AlgoTrade Pro loaded successfully!', 'success');
        });

        // Start system monitoring
        setInterval(checkSystemHealth, 30000); // Check every 30 seconds

        // Load saved theme
        if (localStorage.getItem('theme') === 'dark') {
            document.body.classList.add('dark-mode');
            document.querySelector('.theme-toggle i').className = 'fas fa-sun';
        }

        // Final initialization log
        console.log('ðŸš€ AlgoTrade Pro - Complete Algorithmic Trading Platform Loaded Successfully!');
        console.log('âœ… WORKING: Dashboard | Paper Trading');
        console.log('â³ COMING SOON: Strategy Builder | Backtesting | Live Trading | Portfolio Management');
        console.log('â³ COMING SOON: Risk Management | Market Data | Research Lab | Optimization');
        console.log('â³ COMING SOON: Alerts | Analytics | Options Trading | Trade Reports | Broker Integration | Settings');
        console.log('âœ… Ready for trading operations!');
    </script>
</body>
</html>
